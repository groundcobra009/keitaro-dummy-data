# Query関数練習問題

Google SheetsのQuery関数を効率的に学習するための練習シートを自動作成するスクリプトです。

**最終更新日: 2025/07/31**

## ファイル

- `query_function_practice.gs` - メインスクリプト

## 作成される練習シートの内容

### 1. サンプルデータ
- **社員データ**: 12名の社員情報（ID、氏名、部署、役職、給与、年齢、性別など）
- **売上データ**: 9件の売上トランザクション（日付、商品、金額、地域、顧客タイプなど）

### 2. 基本クエリ練習
Query関数の基本的な使い方を学習：
- 全データ取得
- 特定列の取得
- 条件付き検索
- 数値条件
- 並び替え
- 基本集計

### 3. 高度クエリ練習
より複雑なQuery関数の使い方を学習：
- 複数条件（AND/OR）
- 文字列検索（LIKE演算子）
- 範囲条件（BETWEEN）
- 各種集計関数
- 日付範囲検索

### 4. 練習問題（10問）
実践的な問題で理解度チェック：
- 基本検索
- 数値・文字列条件
- 複合条件
- 並び替え
- 集計処理
- 売上データ分析

### 5. 解答例
全ての練習問題の解答Query関数を提供

## 💻 完成版スプレッドシート（コピーして使用）

以下のリンクから完成版のQuery関数練習シートにアクセスできます：

**📊 [Query関数練習シート（完成版）](https://docs.google.com/spreadsheets/d/11IN7eyhHEoh8w8O7G26r6CmCWyhg5fhNAUVCrfDvRhc/edit?usp=sharing)**

### 使用方法：
1. 上記リンクをクリック
2. 「ファイル」→「コピーを作成」を選択
3. 自分のGoogleドライブにコピーが作成されます
4. コピーしたシートで自由に練習してください

## 🛠️ GASスクリプトでの作成方法

自分でスクリプトから作成したい場合：

1. Google Apps Scriptで新しいプロジェクトを作成
2. `query_function_practice.gs`の内容をコピー&ペースト
3. `main()`関数を実行
4. 作成されたスプレッドシートのURLがログに出力されます

## 学習の進め方

1. **サンプルデータ**でデータ構造を確認
2. **基本クエリ練習**で基本構文を理解
3. **高度クエリ練習**で応用テクニックを習得
4. **練習問題**で実力テスト
5. **解答例**で答え合わせ

## Query関数の基本構文

```
=QUERY(データ範囲, "SQL文", ヘッダー行数)
```

### よく使用するSQL文
- `SELECT *` - 全列選択
- `SELECT A,B,C` - 特定列選択
- `WHERE 条件` - 条件絞り込み
- `ORDER BY 列名 ASC/DESC` - 並び替え
- `GROUP BY 列名` - グループ化
- `COUNT()`, `SUM()`, `AVG()` - 集計関数

## 📝 練習問題一覧

### 【問題1】基本的な検索
女性社員のみを表示してください。

### 【問題2】数値条件
給与が35万円以上の社員の氏名、部署、給与を表示してください。

### 【問題3】文字列検索
氏名に「田」が含まれる社員を全て表示してください。

### 【問題4】複数条件
開発部で給与が35万円以上の社員を表示してください。

### 【問題5】並び替え
全社員を年齢の若い順に並び替えて表示してください。

### 【問題6】集計
部署別の社員数を求めてください。

### 【問題7】役職別集計
役職別の平均給与を求めてください。

### 【問題8】売上データ分析
2024年2月の売上データのみを表示してください。

### 【問題9】高度な集計
地域別の売上合計を求めてください。

### 【問題10】複合条件
法人顧客で売上金額が5万円以上の取引を表示してください。

---

💡 **ヒント**: 解答例は練習シートの「解答例」タブで確認できます！