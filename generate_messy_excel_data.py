import pandas as pd
import numpy as np
import random
import datetime

# 汚いExcelデータを生成する関数

def create_messy_sales_report():
    """
    営業レポートの汚いExcelファイルを作成（pandasで簡易版）
    - 不統一なフォーマット
    - 途中に集計行
    - 不必要な空行
    """
    
    # ヘッダー情報
    header_rows = [
        ['株式会社ABC商事'],
        ['営業部売上実績報告書'],
        [''],
        ['作成者：田中太郎'],
        ['作成日：2024/12/15'],
        ['※このデータは社外秘です！！'],
        [''],
        [''],
        ['No.', '営業担当者', '顧客名', '商品', '単価（円）', '数量', '売上金額', '受注日', '備考']
    ]
    
    # メインデータ（汚く作る）
    messy_data = [
        [1, "佐藤", "A商事", "パソコン", "¥80,000", "3台", "240000", "2024/1/15", "急ぎ"],
        [2, "田中　太郎", "B工業㈱", "プリンター", 45000, "2", "90,000円", "2024/01/20", ""],
        ["", "", "", "", "", "", "", "", ""],  # 空行
        [3, "鈴木", "C産業", "モニター", "¥25,000", "５", "125000", "2024/2/1", ""],
        ["＊小計", "", "", "", "", "10", "455,000", "", ""],  # 途中集計
        [4, "高橋", "D電機", "キーボード", "3000", "10個", "30000", "2024/02/05", ""],
        [5, "渡辺", "E商店", "マウス", "¥2,500", "20", "50,000", "2024/2/10", "まとめ買い割引適用"],
        [6, "伊藤", "F会社", "パソコン", "80000", "1台", "80000", "2024年2月15日", ""],
        [7, "山田", "G株式会社", "プリンター", "¥45,000", "3", "135,000円", "2024/02/20", ""],
        ["", "", "", "", "", "", "", "", ""],  # 空行
        [8, "中村", "H産業", "モニター", "25000円", "4", "¥100,000", "2024/3/1", ""],
        [9, "小林", "I商事", "キーボード", "3,000", "15台", "45000", "2024/03/05", ""],
        [10, "加藤", "J電子", "マウス", "¥2,500", "30", "75,000", "24/3/10", ""],
        ["", "", "", "", "", "", "", "", ""],
        ["合計金額：", "", "", "", "", "", "¥980,000", "", ""],
        ["", "", "", "", "", "", "", "", ""],
        ["※このデータには不備がある可能性があります", "", "", "", "", "", "", "", ""],
        ["※要データクレンジング", "", "", "", "", "", "", "", ""]
    ]
    
    # 全データを結合
    all_data = header_rows + messy_data
    
    # DataFrameに変換
    df = pd.DataFrame(all_data)
    
    # CSVファイルに保存（Excel形式はライブラリの問題で制限）
    df.to_csv("/Users/keitaro/Documents/Cursor/20250726ダミーデータ/data/excel/messy_sales_report.csv", 
              index=False, header=False, encoding='utf-8-sig')

def create_messy_employee_data():
    """
    従業員データの汚いExcelファイルを作成
    - 重複データ
    - 不統一なフォーマット
    - 欠損値
    - 異なる日付形式
    """
    
    # 汚いデータを作成
    messy_employee_data = {
        '社員番号': [
            'EMP001', 'EMP002', 'EMP003', 'EMP001', 'EMP004', '',  # 重複と欠損
            'emp005', 'EMP006', 'EMP-007', 'EMP008', 'EMP009', 'EMP010',
            'EMP011', 'EMP012', 'EMP13', '014', 'EMP015'
        ],
        '氏名': [
            '田中太郎', '佐藤花子', '鈴木一郎', '田中　太郎', '高橋美咲',  # 重複（スペース違い）
            '渡辺', '伊藤健二', '山田　三郎', '中村さくら', '小林 次郎',
            '加藤真理', '', '吉田大輔', '松本由美', '青木　拓也',  # 欠損
            '藤田', '森本和子'
        ],
        '部署': [
            '営業部', '総務部', '開発部', '営業部', '人事部',
            '営業', '開発部', '営業部', '総務部', '開発部',  # 不統一
            'マーケティング部', '営業部', '開発', '総務部', '営業部',
            '', '人事部'  # 欠損
        ],
        '入社日': [
            '2020/04/01', '2019-03-15', '2021/10/1', '2020年4月1日', '2022/7/15',
            '2018.12.10', '2021-09-01', '2020/04/01', '19/05/20', '2021年10月15日',
            '2022/8/1', '2023-01-10', '2020/4/1', '', '2021/11/30',  # 欠損
            '2019年12月25日', '2022-03-01'
        ],
        '年齢': [
            28, '30歳', 25, 28, 'さんじゅうに', 35, '27', 29, 26, '31',
            33, '', 30, 28, 27, 'よんじゅう', 29  # 不統一と欠損
        ],
        '給与': [
            250000, '300,000円', 280000, '25万円', 320000,
            '35万', 270000, '¥290,000', 260000, 310000,
            '330,000', 275000, '28万円', '', 285000,  # 欠損
            '¥320,000', 295000
        ],
        '電話番号': [
            '090-1234-5678', '080-9876-5432', '090-1111-2222', '09012345678', '080-3333-4444',
            '070.5555.6666', '090-7777-8888', '080-9999-0000', '090(1234)5678', '080-1111-2222',
            '070-3333-4444', '', '090-5555-6666', '080-7777-8888', '090-9999-0000',
            '080.1234.5678', '090-1111-3333'
        ],
        'メールアドレス': [
            'tanaka@company.com', 'sato@company.com', 'suzuki@company.com', 'tanaka@company.com',
            'takahashi@company.com', 'watanabe@', 'ito@company.com', 'yamada@company.com',
            'nakamura@company.com', 'kobayashi@company.com', 'kato@company.com', '',
            'yoshida@company.com', 'matsumoto@company.com', 'aoki@company.com',
            'fujita@company', 'morimoto@company.com'
        ]
    }
    
    # DataFrameを作成
    df = pd.DataFrame(messy_employee_data)
    
    # ヘッダーとフッターを含む全体データを作成
    header_df = pd.DataFrame([
        ['従業員マスターデータ'],
        ['更新日：2024年12月20日'],
        ['注意：このデータには重複や欠損があります'],
        [''],
        [''],
    ])
    
    footer_df = pd.DataFrame([
        [''],
        ['※データクレンジングが必要'],
        ['※重複チェック要'],
        ['合計：' + str(len(df)) + '件'],
    ])
    
    # 全データを結合
    all_data = pd.concat([header_df, df, footer_df], ignore_index=True)
    
    # CSVファイルに保存
    all_data.to_csv('/Users/keitaro/Documents/Cursor/20250726ダミーデータ/data/excel/messy_employee_data.csv',
                    index=False, header=False, encoding='utf-8-sig')

def create_messy_inventory_data():
    """
    在庫データの汚いExcelファイルを作成（pandas版）
    - 複数シート
    - 不統一フォーマット
    """
    
    # 倉庫Aデータ
    warehouse_a_header = [
        ['在庫管理システム - 倉庫A'],
        ['最終更新：2024年12月20日 15:30'],
        [''],
        ['商品コード', '商品名', '在庫数', '単価', '総額', '最終入荷日']
    ]
    
    warehouse_a_data = [
        ['PRD-001', 'ノートパソコン', '15台', '¥80,000', '¥1,200,000', '2024/12/15'],
        ['PRD002', 'デスクトップPC', 8, 120000, '960,000円', '2024/12/10'],
        ['PRD-003', 'プリンター', '25台', '¥45,000', '', '2024/12/12'],  # 総額空欄
        ['', '', '', '', '', ''],  # 空行
        ['PRD-004', 'モニター（24インチ）', '30', '25000円', '¥750,000', '2024年12月8日'],
        ['PRD-005', 'キーボード', '50個', '¥3,000', '150000', '24/12/5'],
        ['PRD-006', 'マウス', 80, '¥2,500', '200,000', '2024/12/3'],
        ['', '', '', '', '', ''],  # 空行
        ['＊小計', '', '208', '', '¥3,260,000', ''],
        ['', '', '', '', '', ''],
        ['PRD-007', 'ヘッドセット', '20台', '8000', '160,000円', '2024/11/28'],
        ['PRD008', 'Webカメラ', '35', '¥12,000', '420000', '2024/11/25'],
        ['PRD-009', 'スピーカー', '15台', '¥15,000', '¥225,000', '2024/11/20'],
    ]
    
    all_data_a = warehouse_a_header + warehouse_a_data
    df_a = pd.DataFrame(all_data_a)
    
    # 倉庫Bデータ
    warehouse_b_data = [
        ['倉庫Bの在庫（アクセサリー類）'],
        [''],
        ['商品コード', '商品名', '在庫'],
        ['ACC-001', 'USB-Cケーブル', '100本'],
        ['ACC-002', 'HDMIケーブル', '50本'],
        ['ACC-003', 'LANケーブル', '80m'],
        ['', '', ''],
        ['合計', '', '230点'],
    ]
    
    df_b = pd.DataFrame(warehouse_b_data)
    
    # CSVファイルとして保存（2つのファイルに分割）
    df_a.to_csv('/Users/keitaro/Documents/Cursor/20250726ダミーデータ/data/excel/messy_inventory_warehouse_a.csv',
                index=False, header=False, encoding='utf-8-sig')
    df_b.to_csv('/Users/keitaro/Documents/Cursor/20250726ダミーデータ/data/excel/messy_inventory_warehouse_b.csv',
                index=False, header=False, encoding='utf-8-sig')

# 全ての汚いCSVファイルを生成
print("汚いデータファイル（CSV形式）を生成中...")
create_messy_sales_report()
print("✓ messy_sales_report.csv 作成完了")

create_messy_employee_data()
print("✓ messy_employee_data.csv 作成完了")

create_messy_inventory_data()
print("✓ messy_inventory_warehouse_a.csv 作成完了")
print("✓ messy_inventory_warehouse_b.csv 作成完了")

print("\nデータ整形練習用の汚いCSVファイルが作成されました！")
print("以下の問題が含まれています：")
print("- 不統一なデータ形式")
print("- 重複データ")
print("- 欠損値")
print("- 不要な空行")
print("- 途中に挿入された集計行")
print("- 異なる日付形式")
print("- 数値の表記ゆれ")
print("- 全角・半角の混在")